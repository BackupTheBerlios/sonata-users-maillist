<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Sonata-users] Lyricwiki patch
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/sonata-users/2011-April/index.html" >
   <LINK REL="made" HREF="mailto:sonata-users%40lists.berlios.de?Subject=Re%3A%20%5BSonata-users%5D%20Lyricwiki%20patch&In-Reply-To=%3CBANLkTinbqr0f5yJhN987Cq8NtJ9YGncJ5A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001253.html">
   <LINK REL="Next"  HREF="001256.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Sonata-users] Lyricwiki patch</H1>
    <B>KL-7</B> 
    <A HREF="mailto:sonata-users%40lists.berlios.de?Subject=Re%3A%20%5BSonata-users%5D%20Lyricwiki%20patch&In-Reply-To=%3CBANLkTinbqr0f5yJhN987Cq8NtJ9YGncJ5A%40mail.gmail.com%3E"
       TITLE="[Sonata-users] Lyricwiki patch">kl7.666 at gmail.com
       </A><BR>
    <I>Wed Apr 27 18:22:40 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001253.html">[Sonata-users] Lyricwiki patch
</A></li>
        <LI>Next message: <A HREF="001256.html">[Sonata-users] Lyricwiki patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1255">[ date ]</a>
              <a href="thread.html#1255">[ thread ]</a>
              <a href="subject.html#1255">[ subject ]</a>
              <a href="author.html#1255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sure, I don't expect the answer about project activity from you =) As it's a
public mail list I hope someone else might share this information with us.
Summer is coming and may be I'll be able to resume my last year work on
sonata and make some more fixes and small enhancements so it'd be nice to
know what is the project's state now.

And what about LyricsWiki changes, I still use sonata as my primary music
player under ubuntu and I like to look through songs lyrics once in a while.
So if I notice something is broken be sure I'll try to fix it and commit to
github =)

On Wed, Apr 27, 2011 at 7:10 PM, Lazaros Koromilas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">koromilaz at gmail.com</A>&gt;wrote:

&gt;<i> On Wed, Apr 27, 2011 at 6:46 PM, KL-7 &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">kl7.666 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I believe this one will do the trick.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Lazaros, I suggest you to look through commits in multani's and my repos.
</I>&gt;<i> &gt; You might find some useful fixes there.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; And I wonder how things are going with sonata. I don't see much activity
</I>&gt;<i> of
</I>&gt;<i> &gt; Paco's team on codingteam. Did they move the repo somewhere else or
</I>&gt;<i> finally
</I>&gt;<i> &gt; decide against resurrecting sonata project?
</I>&gt;<i>
</I>&gt;<i> Hi again,
</I>&gt;<i>
</I>&gt;<i> These are some very helpful fixes; thank you.
</I>&gt;<i> I don't have a clue about the project's activity/decisions.
</I>&gt;<i> I will try to contribute through here as a first step ;)
</I>&gt;<i>
</I>&gt;<i> Lazaros.
</I>&gt;<i>
</I>&gt;<i> &gt; On Wed, Apr 27, 2011 at 2:39 PM, Lazaros Koromilas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">koromilaz at gmail.com</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On Tue, Apr 26, 2011 at 7:35 PM, KL-7 &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">kl7.666 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt; Hi,
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Something really strange happened with their markup lately, so thank
</I>&gt;<i> you
</I>&gt;<i> &gt;&gt; &gt; for
</I>&gt;<i> &gt;&gt; &gt; sharing your patch. Though, I used this one for myself. It avoids
</I>&gt;<i> &gt;&gt; &gt; splitting
</I>&gt;<i> &gt;&gt; &gt; string with the tag that contains simultaneously escaped '&lt;' and
</I>&gt;<i> &gt;&gt; &gt; unescaped
</I>&gt;<i> &gt;&gt; &gt; '&gt;' as it looks a bit unstable for me.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Yep! This seems much better, thanks ;)
</I>&gt;<i> &gt;&gt; Another thing that needs attention is the capitalization rules, for
</I>&gt;<i> &gt;&gt; instance
</I>&gt;<i> &gt;&gt; for the song &quot;Orchestral Manoeuvres In The Dark - She's Leaving&quot; sonata
</I>&gt;<i> &gt;&gt; will get the page:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> <A HREF="http://lyrics.wikia.com/index.php?title=Orchestral%20Manoeuvres%20In%20The%20Dark:She%27S%20Leaving&amp;action=edit">http://lyrics.wikia.com/index.php?title=Orchestral%20Manoeuvres%20In%20The%20Dark:She%27S%20Leaving&amp;action=edit</A>
</I>&gt;<i> &gt;&gt; whereas the logical would be:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> <A HREF="http://lyrics.wikia.com/index.php?title=Orchestral%20Manoeuvres%20In%20The%20Dark:She%27s%20Leaving&amp;action=edit">http://lyrics.wikia.com/index.php?title=Orchestral%20Manoeuvres%20In%20The%20Dark:She%27s%20Leaving&amp;action=edit</A>
</I>&gt;<i> &gt;&gt; where the lyrics actually exist.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; On Tue, Apr 26, 2011 at 7:08 PM, Lazaros Koromilas &lt;
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">koromilaz at gmail.com</A>&gt;
</I>&gt;<i> &gt;&gt; &gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Lyrics fetching was not functional lately,
</I>&gt;<i> &gt;&gt; &gt;&gt; some changes in the markup apparently.
</I>&gt;<i> &gt;&gt; &gt;&gt; This patch fixes it.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; diff --git a/sonata/lyricwiki.py b/sonata/lyricwiki.py
</I>&gt;<i> &gt;&gt; &gt;&gt; index 0cd07fc..d4055c1 100644
</I>&gt;<i> &gt;&gt; &gt;&gt; --- a/sonata/lyricwiki.py
</I>&gt;<i> &gt;&gt; &gt;&gt; +++ b/sonata/lyricwiki.py
</I>&gt;<i> &gt;&gt; &gt;&gt; @@ -42,10 +42,9 @@ class LyricWiki(object):
</I>&gt;<i> &gt;&gt; &gt;&gt;             if content[:len(redir_tag)].lower() == redir_tag:
</I>&gt;<i> &gt;&gt; &gt;&gt;                 addr =
</I>&gt;<i> &gt;&gt; &gt;&gt; &quot;<A HREF="http://lyricwiki.org/index.php?title=%s&amp;action=edit">http://lyricwiki.org/index.php?title=%s&amp;action=edit</A>&quot; %
</I>&gt;<i> &gt;&gt; &gt;&gt; urllib.quote(content.split(&quot;[[&quot;)[1].split(&quot;]]&quot;)[0])
</I>&gt;<i> &gt;&gt; &gt;&gt;                 lyricpage = urllib.urlopen(addr).read()
</I>&gt;<i> &gt;&gt; &gt;&gt; -                content = re.split(&quot;&lt;textarea[^&gt;]*&gt;&quot;,
</I>&gt;<i> &gt;&gt; &gt;&gt; lyricpage)[1].split(&quot;&lt;/textarea&gt;&quot;)[0]
</I>&gt;<i> &gt;&gt; &gt;&gt; -                content = content.strip()
</I>&gt;<i> &gt;&gt; &gt;&gt; -            lyrics =
</I>&gt;<i> &gt;&gt; &gt;&gt; content.split(&quot;&lt;lyrics&gt;&quot;)[1].split(&quot;&lt;/lyrics&gt;&quot;)[0]
</I>&gt;<i> &gt;&gt; &gt;&gt; -            if lyrics.strip() != &quot;&lt;!-- PUT LYRICS HERE (and
</I>&gt;<i> delete
</I>&gt;<i> &gt;&gt; &gt;&gt; this entire line) --&gt;&quot;:
</I>&gt;<i> &gt;&gt; &gt;&gt; +                lyrics = re.split(&quot;&lt;lyrics&gt;&quot;,
</I>&gt;<i> &gt;&gt; &gt;&gt; lyricpage)[1].split(&quot;&lt;/lyrics&gt;&quot;)[0]
</I>&gt;<i> &gt;&gt; &gt;&gt; +            if lyrics.find(&quot;PUT LYRICS HERE&quot;) == -1:
</I>&gt;<i> &gt;&gt; &gt;&gt; +                lyrics = lyrics.strip()
</I>&gt;<i> &gt;&gt; &gt;&gt;                 lyrics = misc.unescape_html(lyrics)
</I>&gt;<i> &gt;&gt; &gt;&gt;                 lyrics = misc.wiki_to_html(lyrics)
</I>&gt;<i> &gt;&gt; &gt;&gt;                 lyrics = lyrics.decode(&quot;utf-8&quot;)
</I>&gt;<i> &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; Sonata-users mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">Sonata-users at lists.berlios.de</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">https://lists.berlios.de/mailman/listinfo/sonata-users</A>
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; --
</I>&gt;<i> &gt;&gt; &gt; Kirill
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt; Sonata-users mailing list
</I>&gt;<i> &gt;&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">Sonata-users at lists.berlios.de</A>
</I>&gt;<i> &gt;&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">https://lists.berlios.de/mailman/listinfo/sonata-users</A>
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Sonata-users mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">Sonata-users at lists.berlios.de</A>
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">https://lists.berlios.de/mailman/listinfo/sonata-users</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Kirill
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Sonata-users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">Sonata-users at lists.berlios.de</A>
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">https://lists.berlios.de/mailman/listinfo/sonata-users</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Sonata-users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">Sonata-users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sonata-users">https://lists.berlios.de/mailman/listinfo/sonata-users</A>
</I>&gt;<i>
</I>


-- 
Kirill
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/sonata-users/attachments/20110427/81da194a/attachment.html">https://lists.berlios.de/pipermail/sonata-users/attachments/20110427/81da194a/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001253.html">[Sonata-users] Lyricwiki patch
</A></li>
	<LI>Next message: <A HREF="001256.html">[Sonata-users] Lyricwiki patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1255">[ date ]</a>
              <a href="thread.html#1255">[ thread ]</a>
              <a href="subject.html#1255">[ subject ]</a>
              <a href="author.html#1255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/sonata-users">More information about the Sonata-users
mailing list</a><br>
</body></html>
